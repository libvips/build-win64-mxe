This file is part of MXE. See LICENSE.md for licensing information.

Contains ad hoc patches for cross building.

From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Kleis Auke Wolthuizen <github@kleisauke.nl>
Date: Mon, 13 May 2019 17:00:00 +0200
Subject: [PATCH 1/1] Build gio, gmodule and gthread static


diff --git a/gio/giomodule.c b/gio/giomodule.c
index 1111111..2222222 100644
--- a/gio/giomodule.c
+++ b/gio/giomodule.c
@@ -1056,25 +1056,6 @@ extern GType _g_win32_network_monitor_get_type (void);
 
 static HMODULE gio_dll = NULL;
 
-#ifdef DLL_EXPORT
-
-BOOL WINAPI DllMain (HINSTANCE hinstDLL,
-                     DWORD     fdwReason,
-                     LPVOID    lpvReserved);
-
-BOOL WINAPI
-DllMain (HINSTANCE hinstDLL,
-	 DWORD     fdwReason,
-	 LPVOID    lpvReserved)
-{
-  if (fdwReason == DLL_PROCESS_ATTACH)
-      gio_dll = hinstDLL;
-
-  return TRUE;
-}
-
-#endif
-
 void *
 _g_io_win32_get_module (void)
 {
diff --git a/gio/meson.build b/gio/meson.build
index 1111111..2222222 100644
--- a/gio/meson.build
+++ b/gio/meson.build
@@ -779,7 +779,7 @@ else
   gio_dtrace_hdr = []
 endif
 
-libgio = library('gio-2.0',
+libgio = static_library('gio-2.0',
   gioenumtypes_h, gioenumtypes_c, gnetworking_h, gio_sources,
   gio_dtrace_hdr, gio_dtrace_obj,
   objects : internal_objects,
diff --git a/gmodule/meson.build b/gmodule/meson.build
index 1111111..2222222 100644
--- a/gmodule/meson.build
+++ b/gmodule/meson.build
@@ -72,7 +72,7 @@ if host_system == 'windows'
   gmodule_sources += [gmodule_win_res]
 endif
 
-libgmodule = library('gmodule-2.0',
+libgmodule = static_library('gmodule-2.0',
   sources : gmodule_sources,
   version : library_version,
   soversion : soversion,
diff --git a/gthread/meson.build b/gthread/meson.build
index 1111111..2222222 100644
--- a/gthread/meson.build
+++ b/gthread/meson.build
@@ -12,7 +12,7 @@ if host_system == 'windows'
   gthread_sources += [gthread_win_res]
 endif
 
-libgthread = library('gthread-2.0',
+libgthread = static_library('gthread-2.0',
   sources : gthread_sources,
   version : library_version,
   soversion : soversion,
